% CONFIGURACIÓN GENERAL ============================================================================================
\documentclass[a4paper, 12pt]{article}

% MÁRGENES
\textheight = 21cm
\textwidth  = 16cm
\topmargin  = -0.5cm
\oddsidemargin = -0.27cm

% IDIOMA Y ENCODING
\usepackage[spanish]{babel}      % Documentos en español
\usepackage[utf8]{inputenc}     

% PAQUETES DE FORMATO Y PRESENTACIÓN
\usepackage{fancyhdr}            % Encabezados y pies
\usepackage[svgnames]{xcolor}    % Colores por nombre
\usepackage{enumerate}           % Listas personalizadas
\usepackage{multicol}            % Varias columnas
\usepackage{tocloft}             % Personalización del índice
\usepackage{etoolbox}
\usepackage{etoc}
\renewcommand{\cftsecleader}{\cftdotfill{\cftdotsep}}
\renewcommand{\cftdotsep}{1.5}
\newcommand{\HRule}{\rule{\linewidth}{0.5mm}}

% PAQUETES DE MATEMÁTICAS
\usepackage{amsmath}             

% PAQUETES PARA FIGURAS Y TABLAS
\usepackage[pdftex]{graphicx}    % Figuras
\graphicspath{{Imágenes/}}
\DeclareGraphicsExtensions{.png,.jpg,.jpeg}
\usepackage{subcaption}          % Subfiguras
\usepackage{float}               % Control H de figuras/tablas
\usepackage{booktabs}            % Tablas profesionales
\usepackage{multirow}            % Celdas múltiples en tablas
\usepackage{adjustbox}           % Escalar tablas/figuras
\usepackage[tablename=Tabla]{caption}
\captionsetup{hypcap=false}      % Evita saltos de enlace incorrectos
\usepackage{footnote}
\makesavenoteenv{tabular}        % Notas al pie dentro de tablas

% HIPERVÍNCULOS Y URLs
\usepackage[colorlinks=true, linkcolor=black, citecolor=black, urlcolor=cyan]{hyperref}
\usepackage{url}

% BIBLIOGRAFÍA Y PARCHES
\usepackage{etoolbox}
\renewcommand{\refname}{} % Quita el título “Referencias” del entorno thebibliography
\apptocmd{\sloppy}{\hbadness 10000\relax}{}{} % Evita warnings por texto muy largo
\AtBeginDocument{\let\oldref\ref\def\ref{\oldref*}}




\begin{document}

% CARÁTULA ==========================================================================================================

\begin{titlepage}
	\centering
	\includegraphics[width=0.2\textwidth]{images/Logo ITBA.png}\par
        \vspace{0.2cm}
	{\LARGE Instrumentación Biomédica II\par} 
	\vspace{0.2cm}
	{\text{Segundo Cuatrimestre 2025}\par}
    \rule{150mm}{0.1mm}
    \vspace{0.7cm}
    
    \includegraphics[width=0.45\textwidth]{images/Logo Stiffio.jpg}\par
        {\Large\bfseries Evaluación de rigidez arterial mediante la medición de velocidad de onda de pulso con fotopletismografía\par}
	\vspace{1cm}
 
    \begin{center}
	{\LARGE\bfseries Grupo 6}\par 
        \vspace{0.1cm}
        \vspace{0.2cm}
            \text{Gluj, Daniela (63404)}\par 
            \text{Jonquieres, Catalina (63369)}\par 
            \text{Orsi, Victoria (62526)}\par 

        \vspace{0.8cm}
        
	{\LARGE\bfseries Profesores}\par 
        \vspace{0.2cm}
            \text{Panza, Gustavo}\par
            \text{Igarreta, Ramón Javier}\par
            \text{Herve Birnie Scott, Santiago}\par
    \end{center}
      
	\vspace{1cm}

	{\large \textbf{Fecha de entrega:} 20/02/2026\par} 
 
\end{titlepage}



% ÍNDICE ===========================================================================================================
% Índice Principal
\newpage
\pagenumbering{gobble}
\etocsettagdepth{main}{subsubsection}   % Mostrar 'main' hasta nivel subsubsection
\etocsettagdepth{anexo}{none}           % Ocultar completamente 'anexo'
\tableofcontents                     

% Índice Anexos
\newpage
\pagenumbering{gobble}
\etocsettagdepth{main}{none}         % Ocultar 'main'
\etocsettagdepth{anexo}{subsection}  % Mostrar 'anexo' hasta nivel subsection
\section*{Anexos}
\etocsettocstyle{}{} % Resetea el estilo para que no imprima el título "Índice" de nuevo automáticamente si no quieres
\tableofcontents     % Genera el segundo índice



% LISTA DE CONTRACCIONES ===========================================================================================================
\newpage
\pagenumbering{gobble}
\section*{Lista de contracciones}
ECV : Enfermedad Cardiovascular



% INTRODUCCIÓN =====================================================================================================
\newpage
\pagenumbering{arabic}
\etocdepthtag.toc{main}
\section{Introducción}

    \subsection{Enfermedades cardiovasculares y rigidez arterial}

    Las enfermedades cardiovasculares (ECV) constituyen uno de los principales problemas de salud pública a nivel mundial y representan la causa más frecuente de morbimortalidad. Según la Organización Mundial de la Salud, las ECV son responsables de aproximadamente 17,9 millones de muertes anuales, lo que equivale a cerca del 33\% del total de fallecimientos a escala global \cite{WHO_CVDs_2023}. Esta tendencia se replica en Argentina, concentrando alrededor del 27\% de las muertes registradas \cite{sac2025}. Asimismo, se estima que estas afecciones impactan en el 36,3\% de los adultos, proporción que aumenta hasta el 46,6\% en personas mayores de 45 años.

    \vspace{0.1cm}

    Dada su elevada prevalencia y las severas consecuencias clínicas asociadas, la detección temprana de factores de riesgo cardiovascular resulta fundamental para reducir la carga de estas patologías. En este contexto, la rigidez arterial (RA) emerge como un marcador subclínico relevante, ya que permite identificar alteraciones vasculares antes de la aparición de manifestaciones clínicas evidentes , favoreciendo la implementación de estrategias preventivas y terapéuticas oportunas \cite{ramirez-velez2015}. 

    \vspace{0.3cm}

    La RA se define como la pérdida progresiva de la capacidad elástica de las arterias, fenómeno que ocurre de manera natural con el envejecimiento, pero que puede verse acelerado por la presencia de diversos factores de riesgo y enfermedades cardiovasculares. Este proceso refleja alteraciones estructurales y funcionales en la pared arterial, tales como el aumento del contenido de colágeno y la disminución de fibras elásticas, lo que conduce a una menor capacidad de amortiguación del pulso cardíaco. 

    \vspace{0.1cm}

    Diversas patologías presentan una asociación directa con el aumento de la rigidez arterial, entre las que se incluyen la hipertensión arterial, la enfermedad coronaria, la insuficiencia cardíaca y el accidente cerebrovascular. En particular, la hipertensión arterial se destaca como uno de los principales determinantes del endurecimiento vascular, ya que la exposición crónica a niveles elevados de presión induce modificaciones estructurales y funcionales en la pared arterial \cite{gomez-sanchez2019}.

    \vspace{0.1cm}
    
    Asimismo, enfermedades inflamatorias crónicas, como la artritis reumatoide, se asocian a un riesgo cardiovascular entre dos y tres veces mayor, también atribuible en parte a la inflamación sistémica y endurecimiento progresivo de la pared arterial. \textcolor{red}{(ACÁ FALTA CITA)}
    
    \vspace{0.1cm}
    De manera similar, las comorbilidades metabólicas, como la diabetes y la obesidad, se encuentran estrechamente vinculadas al aumento de la rigidez arterial. En estos pacientes, mecanismos como el estrés oxidativo, la glicación avanzada de proteínas de la matriz extracelular y la alteración de la función endotelial promueven cambios estructurales en el árbol vascular, acelerando el proceso de endurecimiento arterial. Diversos estudios poblacionales han demostrado que estas alteraciones se asocian a un mayor riesgo de eventos cardiovasculares y cerebrovasculares \cite{banegas2019, sochob2022}.



    \subsection{Velocidad de onda de pulso}

    La medición de la velocidad de la onda de pulso (PWV, por sus siglas en inglés) se considera el estándar de referencia no invasivo para la evaluación de la rigidez arterial \cite{aplimed, benshlomo2014}. La PWV es ampliamente reconocida como el \textit{gold standard} para este propósito, dado que presenta una fuerte correlación con el riesgo cardiovascular, la ocurrencia de eventos ateroscleróticos y el daño de órgano subclínico \cite{hossain2025}. Tanto la rigidez arterial como la velocidad de la onda de pulso (PWV) aumentan de manera casi lineal con la edad, fenómeno ampliamente documentado en la literatura \cite{ramirez-velez2015, banegas2019, london2014}.

    \vspace{0.1cm}

    La determinación de la PWV se basa en el registro del tiempo de tránsito del pulso (PTT) entre dos ubicaciones arteriales, generalmente un punto proximal y otro distal, junto con la estimación de la distancia anatómica recorrida por la onda de presión:

    \[
    \mathrm{PWV} = \frac{Dist}{PTT}
    \]

    El trayecto carotídeo-femoral constituye el estándar de referencia para esta medición. En este caso, se recomienda aplicar un coeficiente de corrección de 0,8 sobre la distancia superficial medida, con el objetivo de aproximar la trayectoria real del flujo arterial. Dicho factor se encuentra respaldado por estudios que comparan mediciones externas con longitudes vasculares reales obtenidas mediante técnicas de imagen, y ha sido validado por consensos internacionales \cite{diaz2020}.

    \vspace{0.1cm}

    Desde el punto de vista fisiológico, las arterias sanas presentan mayor capacidad de amortiguación de la presión pulsátil, lo que enlentece la propagación de la onda. En contraste, arterias rígidas transmiten la onda de presión a mayor velocidad, reflejándose en valores elevados de PWV, los cuales se asocian a un mayor riesgo de infarto de miocardio, accidente cerebrovascular, disecciones arteriales y aneurismas \cite{WHO_CVDs_2023, bia2019}.


    \subsection{Estado del arte}

    La rigidez arterial puede evaluarse mediante diversas técnicas no invasivas, entre las que se destacan la tonometría de aplanamiento, la oscilometría avanzada y la bioimpedancia \cite{bia2019}. Estas metodologías difieren tanto en el principio físico de medición como en la forma de estimar la velocidad de la onda de pulso (PWV), pudiendo realizar mediciones directas o indirectas, simultáneas o secuenciales.

    \vspace{0.1cm}

    La tonometría de aplanamiento es una de las técnicas más validadas para la evaluación de la rigidez arterial y se considera el método de referencia clínico para la medición de la PWV carotídeo-femoral. Este método utiliza un sensor piezoeléctrico que se coloca sobre una arteria superficial, generalmente la carótida y la femoral, registrando de manera secuencial la forma de la onda de pulso en cada sitio. El tiempo de tránsito de la onda se calcula utilizando un electrocardiograma (ECG) como referencia temporal, y la PWV se obtiene a partir de la distancia estimada entre ambos puntos de medición. Un ejemplo ampliamente utilizado de esta tecnología es el sistema SphygmoCor, que ofrece mediciones indirectas pero altamente reproducibles de la rigidez arterial.

    \vspace{0.1cm}

    Por otro lado, la oscilometría avanzada permite evaluar la rigidez arterial a partir de registros de presión obtenidos mediante un manguito inflable, similar al utilizado en la medición convencional de la presión arterial. Sistemas como Arteriograph utilizan un único manguito colocado generalmente en el brazo, con el cual registran las oscilaciones de presión generadas por la onda de pulso incidente y su correspondiente onda reflejada. A partir del análisis temporal entre ambos componentes de la señal, estos dispositivos estiman de manera indirecta la velocidad de la onda de pulso central basándose en modelos hemodinámicos y supuestos teóricos acerca de la propagación y reflexión de la onda de pulso en el árbol arterial.

    \vspace{0.1cm}




% JUSTIFICACIÓN DEL PROYECTO =====================================================================================================
\section{Justificación del Proyecto}

El valor de este proyecto radica en superar limitaciones centrales de los dispositivos actualmente disponibles en la práctica clínica  ... \cite{aplimed}.

Los métodos convencionales para evaluar la rigidez arterial, como la tonometría de aplanamiento o los sistemas de oscilometría avanzada, exigen personal entrenado, resultan poco prácticos para traslados y no permiten un monitoreo domiciliario ni un seguimiento frecuente \cite{aplimed}. Por otra parte, los sensores piezoeléctricos requieren un contacto rígido con la piel, son muy sensibles al movimiento y dependen de la presión aplicada por el operador, lo que dificulta la reproducibilidad y limita su aplicabilidad en consultorios generales \cite{sondeja2019}.
la necesidad de fijación manual del sensor sobre la arteria y la dependencia de la pericia del operador restringen su escalabilidad. Estudios recientes han mostrado que la señal fotopletismográfica (PPG) es una alternativa válida y cada vez más utilizada, ya que ofrece buena tolerancia al movimiento, flexibilidad en los puntos de medición y potencial de integración en dispositivos más accesibles \cite{hellqvist2024}.

    La fotopletismografía (PPG) ha ganado relevancia como alternativa práctica, al permitir registrar la onda de pulso de manera óptica, con buena tolerancia al movimiento y flexibilidad en los puntos de medición (dedo, lóbulo de la oreja, tobillo, etc.) \cite{karimpour2023}. Estudios recientes muestran que la sincronización de señales PPG en diferentes sitios corporales, o bien la combinación PPG-ECG, puede estimar la PWV y otros parámetros de rigidez arterial con resultados comparables a la tonometría \cite{sondeja2019}. Sin embargo, factores como la presión de contacto, la luz ambiental y la variabilidad fisiológica influyen en la señal obtenida, lo cual subraya la importancia de algoritmos de corrección y análisis robustos.



% OBJETIVOS ========================================================================================================
\section{Objetivos}
\subsection{Objetivos de Mínima}
\begin{enumerate}
    \item \textbf{Estimación de la velocidad de onda de pulso (PWV)}\par 
    Determinar la velocidad de propagación de la onda de pulso arterial (PWV) a partir de la distancia estimada entre los sensores proximal y distal, y del tiempo de tránsito del pulso (PTT) obtenido mediante el análisis de las señales fotopletismográficas registradas.
    \vspace{0.1cm}
    
    \item \textbf{Determinación de la frecuencia cardíaca (HR)}\par 
    Calcular la frecuencia cardíaca (HR) mediante la detección del intervalo entre pulsos consecutivos. 
    \vspace{0.1cm}
    
    \item \textbf{Visualización de resultados en una interfaz gráfica}\par 
    Diseñar y desarrollar una aplicación de escritorio que permita visualizar los valores calculados de PWV y HR, así como graficar las señales fotopletismográficas (PPG) adquiridas por los sensores proximal y distal. 
    \vspace{0.1cm}

    \item \textbf{Gestión y almacenamiento de datos del paciente}\par 
    Desarrollar e implementar una base de datos que permita almacenar y acceder a las mediciones históricas de cada paciente desde la app, facilitando el seguimiento y la comparación de resultados a lo largo del tiempo.
    \vspace{0.1cm}
    
    \item \textbf{Comparación del valor obtenido con valores fisiológicos normales}\par 
    Indicar si el valor obtenido de PWV se encuentra dentro de los rangos normales reportados en la literatura para el grupo etario del paciente.
    \vspace{0.1cm}

    \item \textbf{Validación de resultados}\par 
    Validar las mediciones de HR y PWV obtenidas con el dispositivo a partir de su comparación con un dispositivo clínico de referencia (Arteriograph, provisto por el ICBA), evaluando concordancia y precisión.
    \vspace{0.1cm}

    \item \textbf{Diseño y desarrollo de la carcasa del dispositivo}\par 
    Diseñar y fabricar una carcasa que asegure la correcta fijación de los componentes internos. El diseño debe contemplar un compartimiento de baterías aislado y de fácil acceso para el usuario, así como la integración de una pantalla táctil que posibilite el ingreso de los datos del paciente sin necesidad de la app.
    \vspace{0.1cm}

    \item \textbf{Encapsulado de sensores}\par 
    Diseñar y desarrollar un encapsulado robusto para los sensores proximal y distal que asegure su correcto funcionamiento y mejore su durabilidad en un contexto clínico, evitando el contacto directo de la electrónica con la piel del paciente y garantizando comodidad durante su uso.
    \vspace{0.1cm}

    
\end{enumerate}
\vspace{0.2cm}


\subsection{Objetivos de Máxima}
\begin{enumerate}
    \item \textbf{Autonomía del dispositivo}\par 
    Calcular y visualizar los valores de HR, PWV y las curvas fotopletismográficas directamente desde el dispositivo, sin necesidad de utilizar una app externa ni conexión a WiFi, permitiendo su uso de forma autónoma.
    \vspace{0.1cm}

    \item \textbf{Generación de reportes de medición}\par 
    Incorporar en la app la opción de generar reportes de medición en formato PDF, destinados tanto a su impresión como a su envío digital al paciente, incluyendo los datos identificatorios del mismo y los valores obtenidos durante el estudio.
    \vspace{0.1cm}

    \item \textbf{Búsqueda de registros}\par 
    Facilitar la consulta de las mediciones almacenadas en la base de datos mediante la implementación de un sistema de búsqueda que permita localizar registros por nombre, apellido o ID, incorporando además filtros por rango de fechas para una gestión eficiente del historial clínico.
    \vspace{0.1cm}


\end{enumerate}
\vspace{0.2cm}

    

% DESCRIPCIÓN GENERAL ==============================================================================================
\section{Descripción General y Uso Previsto}
El presente proyecto se centra en el desarrollo de un sistema de bajo costo y alta fiabilidad para la cuantificación de la rigidez arterial mediante la medición de la Velocidad de la Onda de Pulso (PWV). El sistema emplea sensores de fotopletismografía (PPG) ubicados estratégicamente para capturar la onda de pulso en dos puntos del trayecto arterial:

\begin{itemize}
    \item \textbf{Sensor proximal:} colocado a nivel de la arteria carótida (cuello).
    \item \textbf{Sensor distal:} colocado a nivel de la arteria radial (muñeca).
\end{itemize}

A partir de la diferencia temporal entre las señales proximal y distal, el dispositivo determina el tiempo de tránsito de pulso (PTT). Con este valor y la distancia anatómica estimada entre los puntos de medición, se calcula la PWV. La distancia se obtiene mediante una función de estimación basada en la altura del paciente. Además, con la señal obtenida del sensor proximal, se calcula la frecuencia cardíaca (HR) como variable adicional.

El diagrama de bloques general del sistema se ilustra en la Figura~\ref{fig:Diagrama de Bloques}.

\begin{figure}[H]
\centering
\includegraphics[width=0.9\textwidth]{images/Diagrama de Bloques.png}
\caption{Diagrama de bloque general del funcionamiento  del dispositivo.}
\label{fig:Diagrama de Bloques}
\end{figure}

El dispositivo está dirigido al uso en consultorio clínico. La propuesta no busca reemplazar a los sistemas de referencia hospitalarios, sino brindar una herramienta de apoyo confiable, pensada para médicos clínicos que deseen incorporar la evaluación de rigidez arterial en controles de rutina. 



% MATERIALES Y MÉTODOS =============================================================================================
\section{Materiales y Métodos}

    % HARDWARE -----------------------------------------------------------------------------------------------------
    \subsection{Hardware}
        \subsubsection{Circuito Electrónico}
        El  sistema de procesamiento esta constituido por un microcontrolador ESP32 (modelo DEVKIT-V1), seleccionado por su arquitectura de doble núcleo y elevada precisión temporal, característica imprescindible para medir con exactitud los intervalos entre señales fotopletismográficas y, de este modo, calcular correctamente el tiempo de tránsito del pulso. Además, este microcontrolador ofrece múltiples canales de comunicación I²C, lo que facilita la conexión simultánea de los periféricos digitales utilizados en el dispositivo.

        Para la adquisición de las señales fotopletismográficas se emplearon dos sensores MAX30102, ubicados en posiciones dos anatómicas diferentes (proximal y distal). Ambos módulos se comunican con el ESP32 mediante el protocolo I²C. Para evitar conflictos de dirección y garantizar la lectura simultánea, se implementaron dos buses independientes, asignando pares de pines distintos para las líneas de datos (SDA) y reloj (SCL) de cada sensor. Adicionalmente, se integraron etapas de filtrado en cada puerto de conexión, compuestas por un arreglo de capacitores en paralelo (10 $\mu$F y 100 nF). Estos actúan como condensadores de desacople, filtrando el ruido de alta frecuencia y estabilizando la tensión de suministro ante variaciones rápidas en el consumo de los sensores.

        Por otro lado, se integró una  pantalla TFT táctil de 4 pulgadas con comunicación SPI. Este módulo de visualización permite graficar las ondas de pulso con alta resolución y recibir comandos del usuario, otorgando autonomía al dispositivo. De manera análoga a los sensores, se incorporó un capacitor de 100 nF en la entrada de alimentación de la pantalla para filtrar ruido de alta frecuencia y evitar caídas de tensión transitorias que podrían manifestarse como parpadeos o variaciones indeseadas en el brillo del display.

        Adicionalmente, se incorporó un LED rojo conectado a la línea de alimentación con el objetivo de indicar el estado de encendido del equipo. Asimismo, a modo de retroalimentación auditiva ante la presión de los botones de la pantalla y para la emisión de alertas sonoras, se incluyó un buzzer activo. Dado que la corriente requerida por el buzzer podría superar la capacidad de entrega segura de los pines del microcontrolador, se implementó un circuito driver utilizando un transistor BC548 en configuración de conmutador. Dicho transistor es controlado por un pin digital del ESP32 a través de una resistencia de base de 1 k$\Omega$, actuando como un interruptor electrónico que permite manejar la carga del buzzer sin comprometer la integridad del microcontrolador.

        La alimentación del sistema se realiza mediante 4 baterías AA recargables, conectadas a la placa principal mediante un conector Molex de 2 pines. La tensión de entrada es luego acondicionada por un regulador de voltaje que entrega los 3.3 V estables a todos los componentes. Al igual que en los sensores, se incluyeron dos capacitores de desacople (10uF y 100nF) a la salida del regulador para amortiguar transitorios de tensión.

        \vspace{0.2cm}

        En la Figura \ref{fig:Circuito} se presenta el esquema completo del circuito diseñado. La asignación de pines utilizada para la conexión de los distintos componentes se detalla en el Anexo \ref{anexo:ConexionPines}.

        \begin{figure}[H]
        \centering
        \includegraphics[width=1\textwidth]{images/Circuito.jpeg}
        \captionsetup{margin=1.5cm, justification=centering}
        \caption{Esquema del circuito implementado (las entradas de tensión se corresponden con la salida del regulador).}
        \label{fig:Circuito}
        \end{figure}


        \vspace{0.1cm}

        Finalmente, se confeccionó el circuito descripto sobre una placa de cobre doble faz. La elección de una PCB de dos capas permitió optimizar la distribución del cableado y ubicar estratégicamente todos los componentes mencionados de acuerdo con el diseño de la carcasa. El resultado de la placa final se muestra en la Figura \ref{fig:Placa}.

        
        \begin{figure}[H]
        \centering
        
        \begin{minipage}[b]{0.45\textwidth}
            \centering
            \includegraphics[width=\textwidth]{images/Placa Front.png}
        \end{minipage}
        \hspace{0.01cm} 
        \begin{minipage}[b]{0.45\textwidth}
            \centering
            \includegraphics[width=\textwidth]{images/Placa Back.png}
        \end{minipage}
        
        \captionsetup{margin=1.5cm, justification=centering}
        \caption{Frente (izquierda) y contrafrente (derecha) de la PCB.}
        \label{fig:Placa}
        \end{figure}

    

        
        \subsubsection{Diseño y Fabricación de Carcasa}
        El diseño de la carcasa del dispositivo se realizó utilizando el software de diseño asistido por computadora \textit{SolidWorks}. El modelo tridimensional completo, así como las vistas que detallan la geometría y las características constructivas de la pieza, se presentan en el Anexo \ref{anexo:ModeloCarcasa}.
        
        \vspace{0.2cm}

        El diseño fue concebido con el objetivo de alojar de manera segura los componentes electrónicos y, al mismo tiempo, facilitar la interacción del usuario con el dispositivo. En uno de los laterales de la carcasa se incorporó un orificio destinado al interruptor de encendido y apagado, mientras que en el panel trasero se dispusieron dos orificios para colocar los conectores de los sensores.

        La tapa superior cuenta con una abertura rectangular que permite la correcta visualización de la pantalla, un orificio adyacente para el LED indicador de encendido y un segundo orificio de menor tamaño para permitir la salida del sonido generado por el buzzer. Además, incorpora dos soportes elásticos destinados a sujetar el lápiz, el cual facilita la interacción del usuario con la interfaz táctil.
        La tapa se fija al cuerpo de la carcasa mediante tornillos con cabeza Allen, los cuales atraviesan también la placa electrónica, asegurando su correcta sujeción. Esta configuración dificulta el acceso del usuario a los componentes internos, limitando la apertura del dispositivo únicamente a situaciones que requieran mantenimiento o servicio técnico.

        Por otro lado, en la parte inferior de la carcasa se incorporó un compartimiento independiente, aislado del área donde se encuentra la placa electrónica, destinado al alojamiento de las baterías. Este compartimiento incluye un portapilas para las cuatro baterías AA y presenta un diseño de fácil acceso mediante una tapa deslizante. El cierre de la misma se asegura a través de un mecanismo de encastre a presión. 

        Finalmente, para garantizar la fijación del dispositivo a la mesa de trabajo y evitar su desplazamiento, se dispusieron una serie de ventosas en la base de la carcasa. Este sistema de anclaje epreviene caídas accidentales provocadas por la posible tensión al manipular los cables de los sensores durante las mediciones.

        \vspace{0.2cm}

        La totalidad de la carcasa se fabricó mediante impresión 3D utilizando filamento PLA negro. Las dimension final del  En la Figura \ref{fig:Carcasa} se exhibe el dispositivo final ensamblado, así como el detalle de sus partes anteriormente descriptas.

        \begin{figure}[H]
        \centering
        
        \begin{minipage}[b]{0.4\textwidth}
            \centering
            \includegraphics[width=\textwidth]{images/Caja 2.png}
        \end{minipage}
        \hspace{0.01cm} 
        \begin{minipage}[b]{0.4\textwidth}
            \centering
            \includegraphics[width=\textwidth]{images/Caja 1.png}
        \end{minipage}
        
        \caption{Carcasa impresa en 3D.}
        \label{fig:Carcasa}
        \end{figure}

        
        Para la conexión de los sensores al dispositivo, se eligieron conectores metálicos circulares de 4 pines. Estos incluyen un mecanismo de acople roscado que garantiza una sujeción firme y previene desconexiones accidentales durante el uso. 
        
        Adicionalmente, con el fin de guiar al usuario en su correcta conexión, se implementó un sistema de identificación por colores. Se dispuso un indicador visual sobre cada puerto en correspondencia con el sensor asignado: rojo para el proximal y rosa para el distal, tal como se ilustra en la Figura \ref{fig:Colores Conectores}.

        \begin{figure}[H]
        \centering
        \includegraphics[width=0.6\textwidth]{images/Codigo Colores.png}
        \caption{Referencias de colores para correcta conexión de los sensores al dispositivo}
        \label{fig:Colores Conectores}
        \end{figure}

        \vspace{0.2cm}
        

        \subsubsection{Encapsulado de Sensores}
        Para el encapsulado de los sensores MAX30102 se diseñó un conjunto compuesto por dos piezas complementarias, orientadas a garantizar tanto la correcta funcionalidad óptica como la ergonomía del dispositivo.

        La pieza frontal corresponde a una carcasa rígida fabricada mediante impresión 3D en PLA, cuyo objetivo es aislar el componente electrónico del contacto directo con la piel. Esta pieza presenta una ventana óptica de dimensiones acotadas, diseñada para asegurar la adecuada transmisión de luz hacia el tejido y la correcta recepción de la señal reflejada. 
        Además, con el objetivo de proteger la integridad del cableado, se incorporó en la base de la pieza un prensacables metálico, el cual actúa como alivio de tensión mecánica, evitando la rotación axial del cable y reduciendo el riesgo de fatiga o ruptura de las soldaduras internas por tracción.
        Detalles adicionales sobre el diseño y modelado de esta pieza pueden observarse en el Anexo \ref{anexo:ModeloSensor}.

        La pieza trasera consiste en una funda de silicona flexible en la cual se inserta la pieza frontal descripta anteriormente. Esta funda cumple la función de ocultar las conexiones eléctricas, otorgando al conjunto una estética más limpia y segura. Asimismo, esta estructura incorpora en sus laterales dos elásticos con cierres de velcro que permiten un ajuste firme alrededor del cuello o la muñeca del paciente, adaptándose a la medida que sea necesaria.

        \vspace{0.2cm}

        Ambas piezas que conforman el encapsulado pueden observarse en detalle en las Figuras \ref{fig:Sensor Front} y \ref{fig:Sensor Back}, mientras que el ensamble final del sensor se presenta en la Figura \ref{fig:Sensor}.
    

        \begin{figure}[H]
        \centering
        
        \begin{minipage}[b]{0.35\textwidth}
            \centering
            \includegraphics[width=\textwidth]{images/Sensor Front.png}
        \end{minipage}
        \hspace{0.01cm} 
        \begin{minipage}[b]{0.35\textwidth}
            \centering
            \includegraphics[width=\textwidth]{images/Sensor Front 2.png}
        \end{minipage}
        
        \captionsetup{margin=1.5cm, justification=centering}
        \caption{Frente (izquierda) y contrafrente (derecha) de la pieza frontal para el encapsulado del sensor.}
        \label{fig:Sensor Front}
        \end{figure}



        \begin{figure}[H]
        \centering
        
        \begin{minipage}[b]{0.45\textwidth}
            \centering
            \includegraphics[width=\textwidth]{images/Sensor Back.png}
        \end{minipage}
        \hspace{0.01cm} 
        \begin{minipage}[b]{0.45\textwidth}
            \centering
            \includegraphics[width=\textwidth]{images/Sensor Back 2.png}
        \end{minipage}
        
        \captionsetup{margin=1.5cm, justification=centering}
        \caption{Frente (izquierda) y contrafrente (derecha) de la pieza frontal para el encapsulado del sensor.}
        \label{fig:Sensor Back}
        \end{figure}



        \begin{figure}[H]
        \centering
        \includegraphics[width=0.5\textwidth]{images/Sensor.png}
        \captionsetup{margin=1.5cm, justification=centering}
        \caption{Encapsulado completo y ensamblado del sensor MAX30102}
        \label{fig:Sensor}
        \end{figure}

        \vspace{0.2cm}

        
    % SOFTWARE -----------------------------------------------------------------------------------------------------
    \subsection{Software}
        \subsubsection{Adquisición y Transmisión de Datos}
        El firmware de la ESP32 se encarga de muestrear las señales infrarrojas provenientes de los sensores MAX30102 a 50 Hz (intervalo de 20 ms). Tras la adquisición, las señales son filtradas y procesadas localmente para obtener en tiempo real la frecuencia cardíaca, cuyo cálculo se detalla en secciones posteriores. Además, el sistema monitorea el estado de conexión de cada sensor, enviando esta información para que la interfaz pueda generar alertas ante cualquier desconexión o falla en la adquisición.

        \vspace{0.1cm}

        La transmisión de datos se realiza mediante conectividad WiFi, donde la ESP32 actúa como servidor y habilita un canal WebSockets en el puerto 81. Este protocolo permite un envío continuo, bidireccional y de baja latencia, adecuado para la visualización en tiempo real.
        Todas las mediciones, métricas procesadas y banderas de estado se empaquetan en un string con formato JSON, lo que permite agrupar múltiples variables en un único mensaje y garantizar que las lecturas de ambos sensores se envíen de forma sincronizada.
        

            
        \subsubsection{Preprocesamiento}
        Para mejorar la calidad de la señal fotopletismográfica adquirida por los sensores MAX30102, se implementó en el microcontrolador un preprocesamiento de la misma.

        \vspace{0.1cm}
        
        La señal original proviene del fotodiodo integrado en el sensor, cuya lectura es digitalizada mediante un conversor analógico–digital (ADC) interno de 18 bits. Este valor corresponde a la luz infrarroja reflejada por el tejido e incluye un componente DC de gran magnitud asociado a la absorción constante de luz, sobre el cual se superpone una componente AC de muy baja amplitud generada por las variaciones pulsátiles del volumen sanguíneo. 

        \vspace{0.1cm}
        
        Dado que la información útil (componente AC) constituye solo una fracción mínima del valor total, y que la alta resolución del ADC del MAX30102 produce valores crudos numéricamente elevados, con un rango amplio que varía entre individuos y entre distintas zonas anatómicas, la visualización directa de la señal resulta dificultosa. En particular, es complejo seleccionar escalas que permitan observar adecuadamente la componente pulsátil para todos los casos. Por este motivo, antes del filtrado se realiza una normalización dividiendo los valores crudos por el máximo representable en 18 bits, permitiendo así escalar la señal a un rango uniforme y adecuado para su graficación.

        \vspace{0.1cm}
        
        Una vez normalizada, la señal se somete a un filtrado secuencial destinado a eliminar las componentes no fisiológicas. En primer lugar, se aplica un filtro pasa altos de primer orden con una frecuencia de corte de 0,5 Hz, cuyo objetivo es suprimir el componente DC y variaciones lentas asociadas al movimiento o cambios de perfusión. A continuación, la salida del pasa altos se procesa mediante un filtro pasa bajos de primer orden con una frecuencia de corte de 5 Hz, que atenúa el ruido de alta frecuencia y preserva únicamente el contenido característico de la onda pulsátil. En conjunto, este filtrado pasa banda resulta adecuado para el rango fisiológico de la señal PPG y mejora significativamente la calidad para la detección de los pulsos y el cálculo de los parámetros derivados.




        \subsubsection{Cálculo de frecuencia cardíaca}
        La señal filtrada ingresa al algoritmo de detección de latidos implementado mediante la función checkForBeat de la librería MAX3010x. Este método identifica un pulso cuando la energía de la señal supera un umbral dinámico, lo que permite adaptarse a variaciones de amplitud propias del contacto o del tejido. Cada vez que se confirma un latido, se calcula el intervalo RR en milisegundos y se convierte a BPM. El valor obtenido se valida dentro de un rango fisiológico razonable para descartar falsos positivos producidos por ruido o artefactos de la señal.


        \vspace{0.1cm}
                
        Los BPM aceptados se almacenan en un buffer circular de 40 muestras, cuyo promedio entero constituye la frecuencia cardíaca final. Este promediado suaviza la variabilidad latido a latido y evita fluctuaciones bruscas en la lectura.

        \vspace{0.1cm}
        Además, para garantizar la estabilidad de la medición antes de mostrarla, el sistema exige detectar diez latidos válidos consecutivos. Sólo después de cumplir este criterio la frecuencia cardíaca se considera confiable. Hasta entonces, la interfaz permanece en el estado “Procesando...”. Una vez estabilizada la detección, la lectura final en BPM se actualiza tanto en la interfaz gráfica como en el display OLED del dispositivo.


        \vspace{0.1cm}
        
        Si en algún instante los sensores pierden contacto, es decir la señal IR detectada se encuentra por debajo del umbral de apoyo, todos promedios y contadores se reinician, obligando a reconstruir la secuencia de diez latidos antes de exponer un nuevo valor. Esto evita saltos erráticos y garantiza que la frecuencia cardíaca mostrada represente una estimación suave y robusta. Este mecanismo también permite reiniciar automáticamente la medición al cambiar de persona.


        
        \subsubsection{Cálculo de velocidad de onda de pulso}
        Para esta instancia del procesamiento, los datos provenientes del microcontrolador ya fueron enviados a la computadora para su análisis en Python. En el backend, ambas señales PPG se someten a un segundo filtrado mediante un suavizado exponencial, cuyo objetivo es reducir de manera más efectiva el ruido de alta frecuencia sin alterar la morfología del pulso. Esto permite obtener una forma de onda más limpia y estable para las etapas de detección y cálculo posteriores.

        \vspace{0.1cm}

        Una vez acondicionadas las señales, se localiza el pie de cada pulso buscando el mínimo de amplitud previo a cada pico sistólico. Este candidato se valida exigiendo que la primera derivada cambie de signo (negativo a positivo), lo que confirma que se trata del inicio del ascenso sistólico y evita confundir irregularidades o artefactos con el verdadero pie de onda. 

        \vspace{0.1cm}

        Con los pies identificados en ambas señales, se empareja el de la señal proximal con el de la señal distal y se calcula el tiempo de tránsito del pulso ($\Delta t$) como la diferencia temporal entre ambos eventos. El sistema evalúa múltiples latidos consecutivos, descarta retardos fuera del rango fisiológico y aplica estadísticas robustas (mediana y rechazo de valores atípicos) para obtener un valor de ($\Delta t$) representativo. 

        \vspace{0.1cm}
        
        La PWV se obtiene entonces como la razón entre la distancia efectiva recorrida por la onda y dicho retardo temporal. Matemáticamente, esto se expresa como:

        \[ \mathrm{PWV} = \frac{d}{\Delta t} \]

        \vspace{0.1cm}
        
        Antes de actualizar la PWV calculada, el algoritmo exige acumular diez valores válidos, de forma análoga al proceso utilizado para la frecuencia cardíaca. Esto asegura que la estimación presentada en la interfaz sea estable y no esté afectada por fluctuaciones instantáneas.



        \paragraph{Estimación de la distancia}\mbox{}\\

        La estimación de la distancia anatómica recorrida por la onda de pulso se realiza multiplicando la altura del usuario por un factor fijo de 0,436 [ver Anexo]. Este coeficiente proviene de mediciones anatómicas realizadas sobre 32 sujetos de distintas edades, donde se midió con una cinta métrica flexible la distancia externa entre el punto palpable de la arteria carótida en el cuello y el punto palpable de la arteria radial en la muñeca [ver Figura~\ref{fig:Arterias}]. 
        
        Se adoptó esta geometría carótidorradial porque el sensor óptico no resultó práctico en la región púbica: el vello y la ergonomía dificultan la correcta alineación en el trayecto carotidofemoral, comprometiendo la comodidad del paciente. 

        Además, la literatura evidencia que la PWV carótida–radial es reproducible y presenta correlación con marcadores fisiopatológicos centrales, admitiendo consideraciones específicas para su interpretación frente a la central, pero permitiendo una alternativa fiable y robusta en dispositivos ópticos portátiles.\cite{nitta2024}\cite{wang2023}
        
        De este modo, la distancia efectiva coincide con el camino óptico real del hardware y permite estimar la PWV como la razón entre dicha distancia corregida y el $\Delta t$ obtenido a partir de los pies de onda. 

        \begin{figure}[H]
        \centering
        \includegraphics[width=0.5\textwidth]{images/Arterias.jpg}
        \caption{Distancia recorrida por la onda de pulso en A. Aorta ascendente y Tronco braquilocefálico  B. Arteria Carótida; C. Arteria braquial y arteria radial}
        \label{fig:Arterias}
        \end{figure}
        
        \subsubsection{Interfaz Gráfica}
        Se diseñó una interfaz gráfica que permite visualizar los valores medidos por el dispositivo y controlar la sesión de adquisición en tiempo real. La aplicación de escritorio fue desarrollada en Python utilizando el framework PyQt.

        \vspace{0.1cm}
        
        Al iniciar la aplicación, se presenta una ventana destinada a la carga de datos del paciente, donde es posible ingresar nombre, edad, altura y sexo antes de comenzar la medición. El diseño y la disposición de los elementos de esta ventana se muestran en la Figura \ref{fig:Interfaz Datos}.

        \begin{figure}[H]
        \centering
        \includegraphics[width=0.9\textwidth]{images/Interfaz Datos.png}
        \caption{Ventana de carga de datos de la interfaz grafica.}
        \label{fig:Interfaz Datos}
        \end{figure}

        La ventana principal, que se muestra en la Figura \ref{fig:Interfaz Main}, concentra todas las funcionalidades del dispositivo. El botón de control “Iniciar medición” activa la visualización de las señales en tiempo real en el panel derecho. Cada señal se muestra con el mismo color que la funda de silicona del sensor correspondiente, facilitando su identificación. Debajo de las gráficas se presentan los valores calculados de frecuencia cardíaca y PWV. Al presionar nuevamente el botón, la adquisición se detiene y los valores y las señales quedan congelados en pantalla.

        \vspace{0.1cm}
        
        En el panel lateral izquierdo, bajo los datos del paciente, se incluye un gráfico de PWV vs. edad. Sobre él, se indica con un punto indica el valor de PWV medido, permitiendo así visualizar si este se encuentra dentro de los rangos normales para su grupo etario (zona verde) o fuera de ellos (zona roja). Además, debajo del gráfico se indica explícitamente si el valor es normal o no, para mayor claridad.

        \vspace{0.1cm}
        Los parámetros medidos pueden guardarse junto con los datos del paciente haciendo clic en el botón “Guardar medición”. De este modo, se genera un registro histórico que permite conservar las mediciones a lo largo del tiempo, funcionando como una historia clínica electrónica.

        \vspace{0.1cm}
        
        Si se desea realizar una nueva medición, basta con hacer clic en el botón “Nuevo paciente”, lo que devuelve a la ventana de carga de datos para ingresar la información de un paciente diferente.


        \begin{figure}[H]
        \centering
        \includegraphics[width=0.9\textwidth]{images/Interfaz Main.png}
        \caption{Ventana principal de la interfaz grafica.}
        \label{fig:Interfaz Main}
        \end{figure}


    \subsection{Protocolo de Medición}

    \begin{enumerate}
    \item \textbf{Preparación del paciente:}
    \begin{itemize}
        \item Explicar el procedimiento y obtener el consentimiento informado.
        \item Colocar al paciente en decúbito supino, con los brazos relajados, en un ambiente tranquilo y con temperatura controlada (22-26°C).
        \item Evitar cafeína, nicotina, alcohol o ejercicio intenso al menos 3 horas antes.
        \item Permitir un reposo de 5-10 minutos para lograr estabilidad hemodinámica y respiración lenta y normal.
    \end{itemize}
    
    \item \textbf{Preparación del equipo:}
    \begin{itemize}
        \item Encender el dispositivo y verificar el funcionamiento y el estado de conexión de los sensores.
        \item Colocar el sensor proximal (rojo) y el distal (rosa) en sus sitios correspondientes. La colocación correcta de los sensores se detalla más adelante.
    \end{itemize}

    \item \textbf{Ingreso de datos:}
    \begin{itemize}
        \item Completar la información del paciente en la interfaz del equipo (nombre, edad, sexo, altura).
    \end{itemize}

    \item \textbf{Adquisición de señal:}
    \begin{itemize}
        \item Presionar el botón \textbf{“Iniciar medición”} y mantener la adquisición durante 30-60 segundos para obtener ciclos de pulso estables.
        \item Si la señal pletismográfica se ve inestable, reacomodar los sensores antes de continuar.
    \end{itemize}

    \item \textbf{Finalización y visualización:}
    \begin{itemize}
        \item Detener la medición con \textbf{“Detener medición”} cuando la señal sea estable.
        \item Verificar que se muestren correctamente ambas señales pletismográficas, la PWV y la HR.
        \item Si se desea, se pueden guardar las mediciones realizadas presionando \textbf{“Guardar medición”}.
    \end{itemize}
\end{enumerate}

    \paragraph{Colocación del Sensor Proximal (Cuello)}\mbox{}\\
    
    \underline{\textbf{Ubicación:}} Palpar la arteria carótida común en la base del cuello, lateral a la tráquea y a la altura del cartílago cricoides.
    
    \vspace{0.1cm}
    
    \underline{\textbf{Forma de colocación:}} Colocar el sensor sobre el punto de máximo pulso y fijarlo con la correa elástica, asegurando buen contacto sin comprimir la arteria para evitar distorsiones en la señal.


    \paragraph{Colocación del Sensor Distal (Muñeca)}\mbox{}\\

    \underline{\textbf{Ubicación:}} Palpar el pulso en la arteria radial, ubicada en la superficie lateral de la muñeca (lado del pulgar).

    \vspace{0.1cm}
    
    \underline{\textbf{Forma de colocación:}} Colocar el sensor sobre el sitio de máximo pulso y fijarlo con la correa elástica, asegurando buen contacto sin comprimir la arteria para evitar distorsiones en la señal.

    
    
    \subsection{Validación}
    La validación del dispositivo se realizó mediante métodos estadísticos reconocidos internacionalmente, con el objetivo de garantizar precisión, confiabilidad y equivalencia clínica respecto a estándares aceptados. La validación incluyó análisis respecto a valores poblacionales, comparación instrumental frente a gold standard, y estudio de la discriminación entre subgrupos clínicos, en línea con las recomendaciones de guías internacionales y revisiones metodológicas recientes.\cite{sorensen2015}
    
\subsubsection{Validación frente a valores poblacionales}

Se utilizó la t de Student para una muestra (One-Sample T-Test) para comparar la media de las mediciones de velocidad de onda de pulso (PWV) obtenidas en sujetos sanos con el valor medio reportado en la literatura para grupos etarios equivalentes. Este enfoque es recomendado en la verificación clínica de instrumentos de medición biomédica, y cumple con las normas de validación descritas en los estándares IEEE, permitiendo determinar si existe correspondencia entre el prototipo y valores de referencia establecidos. La hipótesis nula es que la media muestral no difiere significativamente del valor de referencia, y los resultados se interpretan bajo un nivel de significancia de /A=0.05.

\subsubsection{Validación frente a equipo gold standard}

La validación instrumental del dispositivo Stiffio se realizó en el marco de una colaboración con el Instituto Cardiovascular de Buenos Aires (ICBA), reconocido referente en investigación clínica y atención cardiovascular. El ICBA proveyó acceso a un equipo Arteriograph, reconocido internacionalmente como gold standard para la medición de la velocidad de onda de pulso (PWV) \cite{sorensen2015}, así como una cohorte de pacientes que incluyó sujetos sanos y pacientes con insuficiencia cardíaca, permitiendo así evaluar el desempeño del dispositivo en escenarios clínicamente relevantes.

Se llevaron a cabo mediciones pareadas en cada paciente, registrando los valores de PWV y frecuencia cardíaca (HR) con ambos dispositivos en condiciones controladas y consecutivas. Los resultados se analizaron mediante la t de Student para muestras pareadas (Dependent T-Test), conforme a las recomendaciones metodológicas internacionales y normas de validación de equipos biomédicos. Este enfoque permitió evaluar la equivalencia instrumental entre Stiffio y el Arteriograph, estableciendo si existían diferencias estadísticamente significativas en las mediciones obtenidas.

 



% RESULTADOS =======================================================================================================
\section{Resultados}

No hay mediciones aún.

Una vez finalizado el proceso de recolección y análisis de datos, los resultados serán presentados de forma estructurada, clara y acorde a los estándares para la evaluación clínica de dispositivos médicos. Para cada grupo y prueba estadística:\cite{ispch2021}

Se mostrarán las estadísticas descriptivas de las variables principales (PWV y HR), incluyendo medias, desvíos estándar y número de casos en cada grupo, para cada rango etario y estado clínico (sanos e insuficientes cardíacos).

Se publicarán ejemplos representativos de las señales adquiridas, permitiendo ilustrar la forma de onda pletismográfica típica y su calidad en diferentes ubicaciones y niveles de perfusión.

Para la t-Student aplicada sobre nuestras mediciones, se reportarán los resultados comparativos de la media poblacional por grupo etario, junto al estadístico t, el valor de p, y la interpretación clínica en términos de significancia y correspondencia con los valores de referencia.

En la comparación pareada con el gold standard (Arteriograph), se mostrarán los gráficos de dispersión, los valores individuales para cada paciente y grupo, y los resultados de la t-Student pareada, evidenciando la concordancia estadística o diferencias entre dispositivos.

Esta estructura asegurará transparencia en la interpretación y alineación con normas regulatorias de presentación de resultados en validaciones clínicas. 


% DISCUSIÓN ========================================================================================================
\section{Discusión}



% CONCLUSIONES =====================================================================================================
\section{Conclusiones}



% BIBLIOGRAFÍA =====================================================================================================

\newpage
\addcontentsline{toc}{section}{Bibliografía} 
\bibliographystyle{IEEEtran}
\bibliography{Referencias}

% ANEXOS ===========================================================================================================
\newpage
\appendix
\etocdepthtag.toc{anexo}
\input{Anexos.tex}

\end{document}